{"version":3,"file":"component.js","sourceRoot":"","sources":["component.ts"],"names":[],"mappings":"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","sourcesContent":["/*!\n * devextreme-angular\n * Version: 19.2.3\n * Build date: Tue Oct 22 2019\n *\n * Copyright (c) 2012 - 2019 Developer Express Inc. ALL RIGHTS RESERVED\n *\n * This software may be modified and distributed under the terms\n * of the MIT license. See the LICENSE file in the root of the project for details.\n *\n * https://github.com/DevExpress/devextreme-angular\n */\n\nimport {\r\n    ElementRef,\r\n    NgZone,\r\n    QueryList,\r\n    SimpleChanges,\r\n    PLATFORM_ID,\r\n    Inject,\r\n    EventEmitter,\r\n\r\n    OnChanges,\r\n    OnInit,\r\n    DoCheck,\r\n    AfterContentChecked,\r\n    AfterViewInit\r\n} from '@angular/core';\r\n\r\nimport { isPlatformServer } from '@angular/common';\r\nimport { TransferState, makeStateKey } from '@angular/platform-browser';\r\n\r\nimport { DxTemplateDirective } from './template';\r\nimport { IDxTemplateHost, DxTemplateHost } from './template-host';\r\nimport { EmitterHelper, NgEventsStrategy } from './events-strategy';\r\nimport { WatcherHelper } from './watcher-helper';\r\nimport * as domAdapter from 'devextreme/core/dom_adapter';\r\nimport * as events from 'devextreme/events';\r\n\r\nimport {\r\n    INestedOptionContainer,\r\n    ICollectionNestedOption,\r\n    ICollectionNestedOptionContainer,\r\n    CollectionNestedOptionContainerImpl\r\n} from './nested-option';\r\n\r\nexport const IS_PLATFORM_SERVER = makeStateKey<any>('DX_isPlatformServer');\r\n\r\nexport abstract class DxComponent implements OnChanges, OnInit, DoCheck, AfterContentChecked, AfterViewInit,\r\n    INestedOptionContainer, ICollectionNestedOptionContainer, IDxTemplateHost {\r\n    private _initialOptions: any = {};\r\n    protected _optionsToUpdate: any = {};\r\n    private _collectionContainerImpl: ICollectionNestedOptionContainer;\r\n    eventHelper: EmitterHelper;\r\n    optionChangedHandlers: EventEmitter<any> = new EventEmitter();\r\n    templates: DxTemplateDirective[];\r\n    instance: any;\r\n    isLinked = true;\r\n    changedOptions = {};\r\n    createInstanceOnInit = true;\r\n    widgetUpdateLocked = false;\r\n\r\n    private _initTemplates() {\r\n        if (this.templates.length) {\r\n            let initialTemplates = {};\r\n            this.templates.forEach(template => {\r\n                initialTemplates[template.name] = template;\r\n            });\r\n            this.instance.option('integrationOptions.templates', initialTemplates);\r\n        }\r\n    }\r\n\r\n    private _initEvents() {\r\n        this.instance.on('optionChanged', (e) => {\r\n            this.changedOptions[e.name] = e.value;\r\n\r\n            const value = e.name === e.fullName ? e.value : e.component.option(e.name);\r\n            this.eventHelper.fireNgEvent(e.name + 'Change', [value]);\r\n            this.optionChangedHandlers.emit(e);\r\n        });\r\n    }\r\n\r\n    private _initOptions() {\r\n        this._initialOptions.integrationOptions.watchMethod = this.watcherHelper.getWatchMethod();\r\n    }\r\n\r\n    private _initPlatform() {\r\n        if (this.transferState.hasKey(IS_PLATFORM_SERVER)) {\r\n            this._initialOptions.integrationOptions.renderedOnServer = this.transferState.get(IS_PLATFORM_SERVER, null);\r\n        } else if (isPlatformServer(this.platformId)) {\r\n            this.transferState.set(IS_PLATFORM_SERVER, true);\r\n        }\r\n    }\r\n\r\n    protected _createEventEmitters(events) {\r\n        this.eventHelper.createEmitters(events);\r\n\r\n        this._initialOptions.eventsStrategy = (instance) => {\r\n            let strategy = new NgEventsStrategy(instance);\r\n\r\n            events.filter(event => event.subscribe).forEach(event => {\r\n                strategy.addEmitter(event.subscribe, this[event.emit]);\r\n            });\r\n\r\n            return strategy;\r\n        };\r\n\r\n        this._initialOptions.nestedComponentOptions = function(component) {\r\n            return {\r\n                eventsStrategy: (instance) => { return new NgEventsStrategy(instance); },\r\n                nestedComponentOptions: component.option('nestedComponentOptions')\r\n            };\r\n        };\r\n    }\r\n\r\n    _shouldOptionChange(name: string, value: any) {\r\n        if (this.changedOptions.hasOwnProperty(name)) {\r\n            const prevValue = this.changedOptions[name];\r\n            delete this.changedOptions[name];\r\n\r\n            return value !== prevValue;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    clearChangedOptions() {\r\n        this.changedOptions = {};\r\n    }\r\n\r\n    protected _getOption(name: string) {\r\n        return this.instance ?\r\n            this.instance.option(name) :\r\n            this._initialOptions[name];\r\n    }\r\n\r\n    lockWidgetUpdate() {\r\n        if (!this.widgetUpdateLocked && this.instance) {\r\n            this.instance.beginUpdate();\r\n            this.widgetUpdateLocked = true;\r\n        }\r\n    }\r\n\r\n    unlockWidgetUpdate() {\r\n        if (this.widgetUpdateLocked) {\r\n            this.widgetUpdateLocked = false;\r\n            this.instance.endUpdate();\r\n        }\r\n    }\r\n\r\n    protected _setOption(name: string, value: any) {\r\n        this.lockWidgetUpdate();\r\n\r\n        if (!this._shouldOptionChange(name, value)) {\r\n            return;\r\n        }\r\n\r\n        if (this.instance) {\r\n            this.instance.option(name, value);\r\n        } else {\r\n            this._initialOptions[name] = value;\r\n        }\r\n    }\r\n\r\n    protected abstract _createInstance(element, options)\r\n\r\n    protected _createWidget(element: any) {\r\n        this._initialOptions.integrationOptions = {};\r\n        this._initPlatform();\r\n        this._initOptions();\r\n\r\n        let createInstanceOnInit = this.createInstanceOnInit;\r\n\r\n        this._initialOptions.onInitializing = function () {\r\n            if (createInstanceOnInit) {\r\n                this.beginUpdate();\r\n            }\r\n        };\r\n        this.instance = this._createInstance(element, this._initialOptions);\r\n        this._initEvents();\r\n        this._initialOptions = {};\r\n    }\r\n\r\n    protected _destroyWidget() {\r\n        if (this.instance) {\r\n            let element = this.instance.element();\r\n            events.triggerHandler(element, 'dxremove', { _angularIntegration: true });\r\n            this.instance.dispose();\r\n            domAdapter.removeElement(element);\r\n        }\r\n    }\r\n\r\n    constructor(protected element: ElementRef,\r\n        ngZone: NgZone,\r\n        templateHost: DxTemplateHost,\r\n        private watcherHelper: WatcherHelper,\r\n        private transferState: TransferState,\r\n        @Inject(PLATFORM_ID) private platformId: any) {\r\n        this.templates = [];\r\n        templateHost.setHost(this);\r\n        this._collectionContainerImpl = new CollectionNestedOptionContainerImpl(this._setOption.bind(this));\r\n        this.eventHelper = new EmitterHelper(ngZone, this);\r\n    }\r\n\r\n    ngOnChanges(changes: SimpleChanges) {\r\n        for (let key in changes) {\r\n            let change = changes[key];\r\n            if (change.currentValue !== this[key]) {\r\n                this._optionsToUpdate[key] = changes[key].currentValue;\r\n            }\r\n        }\r\n    }\r\n\r\n    ngOnInit() {\r\n        if (this.createInstanceOnInit) {\r\n            this._createWidget(this.element.nativeElement);\r\n        }\r\n    }\r\n\r\n    ngDoCheck() {\r\n        this.applyOptions();\r\n    }\r\n\r\n    ngAfterContentChecked() {\r\n        this.applyOptions();\r\n        this.unlockWidgetUpdate();\r\n    }\r\n\r\n    ngAfterViewInit() {\r\n        this._initTemplates();\r\n        if (this.createInstanceOnInit) {\r\n            this.instance.endUpdate();\r\n        }\r\n    }\r\n\r\n    applyOptions() {\r\n        if (Object.keys(this._optionsToUpdate).length) {\r\n            if (this.instance) {\r\n                this.instance.option(this._optionsToUpdate);\r\n            }\r\n            this._optionsToUpdate = {};\r\n        }\r\n    }\r\n\r\n    setTemplate(template: DxTemplateDirective) {\r\n        this.templates.push(template);\r\n    }\r\n\r\n    setChildren<T extends ICollectionNestedOption>(propertyName: string, items: QueryList<T>) {\r\n        return this._collectionContainerImpl.setChildren(propertyName, items);\r\n    }\r\n}\r\n\r\nexport abstract class DxComponentExtension extends DxComponent {\r\n    createInstance(element: any) {\r\n        this._createWidget(element);\r\n    }\r\n}\r\n"]}